name: CI for ShortTrack

on:
  push:
    branches:
      - main        # –ó–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –ø—Ä–∏ –ø—É—à–µ –≤ –≤–µ—Ç–∫—É main
  pull_request:
    branches:
      - main        # –ó–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ PR –≤ –≤–µ—Ç–∫—É main

jobs:
  build-test:
    name: üß™ Build & Test
    runs-on: ubuntu-latest   # –ò—Å–ø–æ–ª—å–∑—É–µ–º Ubuntu –¥–ª—è CI

    steps:
    # 1) –ö–ª–æ–Ω–∏—Ä—É–µ–º —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π
    - name: Checkout repository
      uses: actions/checkout@v3

    # 2) –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Python
    - name: Setup Python
      uses: actions/setup-python@v4
      with:
        python-version: "3.10"  # –£–∫–∞–∑—ã–≤–∞–µ–º –Ω—É–∂–Ω—É—é –≤–µ—Ä—Å–∏—é Python

    # 3) –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
    - name: Install dependencies
      run: |
        python -m pip install --upgrade pip
        pip install -r requirements.txt

    # 4) –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤
    - name: Run tests
      run: |
        if [ -f "pytest.ini" ] || [ -d "tests" ]; then pytest -q; else echo "No tests found ‚Äî skipping"; fi

    # 5) –õ–∏–Ω—Ç–∏–Ω–≥ –∫–æ–¥–∞ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
    - name: Lint Code
      run: |
        pip install flake8
        flake8 .
